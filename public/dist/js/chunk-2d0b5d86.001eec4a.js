(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-2d0b5d86"],{"1b43":function(e,t,a){"use strict";a.r(t);a("8e6e"),a("456d"),a("6b54");var o=a("bd86"),i=(a("ac6a"),a("2edc"));function n(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),a.push.apply(a,o)}return a}function r(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?n(a,!0).forEach(function(e){Object(o.a)(t,e,a[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):n(a).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))})}return t}var l={props:{loading:{default:!1},tableData:{default:function(){return[]}},companyType:{default:function(){return[]}}},data:function(){return{currentTableData:[],multipleSelection:[],auth:{add:!1,set:!1,del:!1,copy:!1},dialogLoading:!1,dialogFormVisible:!1,dialogStatus:"",textMap:{update:"编辑公司",create:"新增公司"},form:{name:void 0,phonetic:void 0,code:void 0,type:void 0},rules:{name:[{required:!0,message:"名称不能为空",trigger:"blur"},{max:50,message:"长度不能大于 50 个字符",trigger:"blur"}],phonetic:[{max:10,message:"长度不能大于 10 个字符",trigger:"blur"}],code:[{required:!0,message:"编码不能为空",trigger:"blur"},{max:30,message:"长度不能大于 30 个字符",trigger:"blur"}],type:[{required:!0,message:"至少选择一项",trigger:"change"},{type:"enum",enum:["0","1","2","3"],message:"值的范围必须为 0 ~ 3",trigger:"change"}]}}},watch:{tableData:{handler:function(e){this.currentTableData=e},immediate:!0}},mounted:function(){this._validationAuth()},methods:{_validationAuth:function(){this.auth.add=this.$has("/setting/logistics/company/add"),this.auth.set=this.$has("/setting/logistics/company/set"),this.auth.del=this.$has("/setting/logistics/company/del"),this.auth.copy=this.$has("/setting/logistics/company/copy")},_getIdList:function(e){null===e&&(e=this.multipleSelection);var t=[];return Array.isArray(e)?e.forEach(function(e){t.push(e.delivery_item_id)}):t.push(this.currentTableData[e].delivery_item_id),t},handleSelectionChange:function(e){this.multipleSelection=e},sortChange:function(e){var t=e.column,a=e.prop,o=e.order,i={order_type:void 0,order_field:void 0};t&&o&&(i.order_type="ascending"===o?"asc":"desc",i.order_field=a),this.$emit("sort",i)},handleCreate:function(){var e=this;this.form={name:void 0,phonetic:void 0,code:void 0,type:void 0},this.$nextTick(function(){e.$refs.form.clearValidate()}),this.dialogStatus="create",this.dialogLoading=!1,this.dialogFormVisible=!0},create:function(){var t=this;this.$refs.form.validate(function(e){e&&(t.dialogLoading=!0,Object(i.a)(r({},t.form)).then(function(e){t.currentTableData.unshift(e.data),t.dialogFormVisible=!1,t.$message.success("操作成功")}).catch(function(){t.dialogLoading=!1}))})},handleDelete:function(e){var t=this,a=this._getIdList(e);0!==a.length?this.$confirm("确定要执行该操作吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",closeOnClickModal:!1}).then(function(){Object(i.c)(a).then(function(){for(var e=t.currentTableData.length-1;0<=e;e--)-1!==a.indexOf(t.currentTableData[e].delivery_item_id)&&t.currentTableData.splice(e,1);t.currentTableData.length<=0&&t.$emit("refresh",!0),t.$message.success("操作成功")})}).catch(function(){}):this.$message.error("请选择要操作的数据")},handleUpdate:function(e){var t=this;this.currentIndex=e;var a=this.currentTableData[e];this.form=r({},a,{type:a.type.toString()}),this.$nextTick(function(){t.$refs.form.clearValidate()}),this.dialogStatus="update",this.dialogLoading=!1,this.dialogFormVisible=!0},update:function(){var t=this;this.$refs.form.validate(function(e){e&&(t.dialogLoading=!0,Object(i.h)(r({},t.form)).then(function(e){t.$set(t.currentTableData,t.currentIndex,r({},t.currentTableData[t.currentIndex],{},e.data)),t.dialogFormVisible=!1,t.$message.success("操作成功")}).catch(function(){t.dialogLoading=!1}))})},copyToHot:function(e){var t=this;Object(i.b)(e).then(function(e){t.currentTableData.unshift(e.data),t.$message.success("操作成功")})}}},s=a("2877"),c=Object(s.a)(l,function(){var a=this,e=a.$createElement,o=a._self._c||e;return o("div",{staticClass:"cs-p"},[o("el-form",{attrs:{inline:!0,size:"small"}},[a.auth.add?o("el-form-item",[o("el-button",{attrs:{disabled:a.loading},on:{click:a.handleCreate}},[o("cs-icon",{attrs:{name:"plus"}}),a._v("\n        新增公司\n      ")],1)],1):a._e(),a.auth.del?o("el-form-item",[o("el-button",{attrs:{disabled:a.loading},on:{click:function(e){return a.handleDelete(null)}}},[o("cs-icon",{attrs:{name:"trash-o"}}),a._v("\n        删除\n      ")],1)],1):a._e(),o("cs-help",{staticStyle:{"padding-bottom":"19px"},attrs:{router:a.$route.path}})],1),o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:a.loading,expression:"loading"}],attrs:{data:a.currentTableData,stripe:""},on:{"selection-change":a.handleSelectionChange,"sort-change":a.sortChange}},[o("el-table-column",{attrs:{type:"selection",width:"35"}}),o("el-table-column",{attrs:{label:"编号",prop:"delivery_item_id",sortable:"custom",width:"100"}}),o("el-table-column",{attrs:{label:"名称",prop:"name",sortable:"custom"}}),o("el-table-column",{attrs:{label:"首拼",prop:"phonetic",sortable:"custom"}}),o("el-table-column",{attrs:{label:"编码",prop:"code",sortable:"custom"}}),o("el-table-column",{attrs:{label:"类型",prop:"type",align:"center",sortable:"custom",width:"100"},scopedSlots:a._u([{key:"default",fn:function(e){return[o("el-tag",{attrs:{size:"mini",effect:"plain",type:e.row.type?"info":"warning"}},[a._v("\n          "+a._s(a.companyType[e.row.type])+"\n        ")])]}}])}),o("el-table-column",{attrs:{label:"操作",align:"center","min-width":"120"},scopedSlots:a._u([{key:"default",fn:function(t){return[a.auth.set?o("el-button",{attrs:{size:"small",type:"text"},on:{click:function(e){return a.handleUpdate(t.$index)}}},[a._v("编辑")]):a._e(),a.auth.del?o("el-button",{attrs:{size:"small",type:"text"},on:{click:function(e){return a.handleDelete(t.$index)}}},[a._v("删除")]):a._e(),a.auth.copy&&0!==t.row.type?o("el-button",{attrs:{size:"small",type:"text"},on:{click:function(e){return a.copyToHot(t.row.delivery_item_id)}}},[a._v("复制为热门")]):a._e()]}}])})],1),o("el-dialog",{attrs:{title:a.textMap[a.dialogStatus],visible:a.dialogFormVisible,"append-to-body":!0,"close-on-click-modal":!1,width:"600px"},on:{"update:visible":function(e){a.dialogFormVisible=e}}},[o("el-form",{ref:"form",attrs:{model:a.form,rules:a.rules,"label-width":"80px"}},[o("el-form-item",{attrs:{label:"名称",prop:"name"}},[o("el-input",{attrs:{placeholder:"请输入快递公司名称",clearable:!0},model:{value:a.form.name,callback:function(e){a.$set(a.form,"name",e)},expression:"form.name"}})],1),o("el-row",[o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{label:"首拼",prop:"phonetic"}},[o("el-input",{attrs:{placeholder:"新增不填写将自动识别",clearable:!0},model:{value:a.form.phonetic,callback:function(e){a.$set(a.form,"phonetic",e)},expression:"form.phonetic"}})],1)],1),o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{label:"编码",prop:"code"}},[o("el-input",{attrs:{placeholder:"请输入快递公司编码",clearable:!0},model:{value:a.form.code,callback:function(e){a.$set(a.form,"code",e)},expression:"form.code"}})],1)],1)],1),o("el-form-item",{attrs:{label:"类型",prop:"type"}},[o("el-select",{staticStyle:{width:"150px"},attrs:{placeholder:"请选择",clearable:"",value:""},model:{value:a.form.type,callback:function(e){a.$set(a.form,"type",e)},expression:"form.type"}},a._l(a.companyType,function(e,t){return o("el-option",{key:t,attrs:{label:e,value:t}})}),1)],1)],1),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{size:"small"},on:{click:function(e){a.dialogFormVisible=!1}}},[a._v("取消")]),"create"===a.dialogStatus?o("el-button",{attrs:{type:"primary",loading:a.dialogLoading,size:"small"},on:{click:a.create}},[a._v("确定")]):o("el-button",{attrs:{type:"primary",loading:a.dialogLoading,size:"small"},on:{click:a.update}},[a._v("修改")])],1)],1)],1)},[],!1,null,null,null);t.default=c.exports}}]);