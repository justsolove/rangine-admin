(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-3e464416"],{"7d92f":function(t,e,a){},"8ade":function(t,e,a){"use strict";var s=a("7d92f");a.n(s).a},a9d4:function(t,e,a){"use strict";a.r(e);a("8e6e"),a("456d");var s=a("bd86"),i=(a("7f7f"),a("ac4d"),a("8a81"),a("ac6a"),a("ca00")),r=a("f663");function n(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,s)}return a}var o={components:{csUpload:function(){return a.e("chunk-ba9a5a82").then(a.bind(null,"8422"))}},props:{loading:{default:!1},tableData:{default:function(){return[]}}},data:function(){return{form:{},formBuffer:[],srcList:[],submitLoading:!1,rules:{content:[{required:!0,message:"回复内容不能为空",trigger:"blur"},{max:200,message:"长度不能大于 200 个字符",trigger:"blur"}]},statusMap:{0:{text:"待处理",type:"warning"},1:{text:"已处理",type:"success"}}}},filters:{getPreviewUrl:function(t,e){return t&&(t.source||t)?i.a.getImageCodeUrl(t.source||t,e):""}},watch:{"tableData.goods_comment_id":{handler:function(t){var e=this;0<t&&(this.formBuffer.hasOwnProperty(t)||(this.formBuffer[t]={goods_comment_id:void 0,content:void 0,image:void 0,isShowReply:!1}),this.form=this.formBuffer[t],this.$nextTick(function(){e.$refs.form.clearValidate()}))}}},methods:{_getUploadFileList:function(t){if(t.length){var e=[],a=!0,s=!1,i=void 0;try{for(var r,n=t[Symbol.iterator]();!(a=(r=n.next()).done);a=!0){var o=r.value;if("success"===o.status){var l=o.response;l&&200===l.status&&l.data&&e.push({name:l.data[0].name,source:l.data[0].url,url:"//"+l.data[0].url})}}}catch(t){s=!0,i=t}finally{try{a||null==n.return||n.return()}finally{if(s)throw i}}this.form.image=e}},setImageSrcList:function(t,e){this.srcList=i.a.setImageSrcList(t,e)},initReplyForm:function(t){var e=this;this.form.goods_comment_id=t,this.form.content="",this.form.image=[],this.form.isShowReply=!0,this.$nextTick(function(){e.$refs.form.clearValidate();var t=e.$el.querySelector("#reply-form");e.$parent.scrollTo(0,t.offsetTop)})},handleFormSubmit:function(){var a=this;this.$refs.form.validate(function(t){if(t){a.submitLoading=!0;var e=a.tableData.goods_comment_id;Object(r.d)(function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?n(a,!0).forEach(function(t){Object(s.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):n(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}({},a.form)).then(function(t){a.form.isShowReply=!1,a.$emit("reply",e,t.data),a.$message.success("操作成功")}).finally(function(){a.submitLoading=!1})}})},handleView:function(t){this.$router.push({name:"goods-admin-view",params:{goods_id:t}})}}},l=(a("8ade"),a("2877")),c=Object(l.a)(o,function(){var s=this,t=s.$createElement,i=s._self._c||t;return i("div",{staticClass:"cs-p"},[i("el-card",{directives:[{name:"loading",rawName:"v-loading",value:s.loading,expression:"loading"}],staticClass:"box-card",attrs:{shadow:"never"}},[i("div",{staticClass:"box-card-header",attrs:{slot:"header"},slot:"header"},[i("el-row",{staticClass:"cs-mb-10"},[i("el-col",{attrs:{span:18}},[i("span",{staticClass:"text-explode"},[s._v("关联商品：")]),i("span",{staticClass:"goods-link",on:{click:function(t){return s.handleView(s.tableData.get_order_goods.goods_id)}}},[s._v(s._s(s.tableData.get_order_goods.goods_name))])]),i("el-col",{attrs:{span:6}},[i("el-rate",{attrs:{disabled:!0,colors:["#99A9BF","#F7BA2A","#FF9900"]},model:{value:s.tableData.score,callback:function(t){s.$set(s.tableData,"score",t)},expression:"tableData.score"}})],1)],1),i("el-row",[i("el-col",{attrs:{span:12}},[i("span",{staticClass:"text-explode"},[s._v("规格：")]),i("span",[s._v(s._s(s.tableData.get_order_goods.key_value))])]),i("el-col",{attrs:{span:6}},[i("span",{staticClass:"text-explode"},[s._v("订单号：")]),i("span",[s._v(s._s(s.tableData.order_no))])]),i("el-col",{attrs:{span:6}},[i("span",{staticClass:"text-explode"},[s._v("状态：")]),null!==s.tableData.status?i("el-tag",{attrs:{type:s.statusMap[s.tableData.status].type,effect:"plain",size:"mini"}},[s._v("\n            "+s._s(s.statusMap[s.tableData.status].text)+"\n          ")]):s._e()],1)],1)],1),i("el-timeline",[i("el-timeline-item",{attrs:{timestamp:"[主评] "+s.tableData.create_time,type:"primary",placement:"top"}},[i("el-card",{staticClass:"action",attrs:{shadow:"never"}},[i("div",{staticClass:"user-icon"},[i("el-avatar",{attrs:{size:"medium",src:s._f("getPreviewUrl")(s.tableData.get_user.head_pic,"head_pic")}},[i("img",{attrs:{src:"image/avatar/user.png",alt:""}})])],1),i("div",{staticClass:"problem"},[i("div",{staticClass:"consult-content cs-pb-10"},[i("span",[s._v(s._s(s.tableData.content))]),i("el-button",{staticClass:"form-button active",attrs:{type:"text",size:"small"},on:{click:function(t){return s.initReplyForm(s.tableData.goods_comment_id)}}},[s._v("回复")])],1),i("div",{staticStyle:{"line-height":"0"}},s._l(s.tableData.image,function(t,e){return i("el-image",{key:e,staticClass:"comment_thumb",attrs:{src:s._f("getPreviewUrl")(t,"comment_thumb_x40"),"preview-src-list":s.srcList,lazy:!0,fit:"cover"},on:{click:function(t){return t.stopPropagation(),s.setImageSrcList(s.tableData.image,e)}}})}),1),i("div",{staticClass:"user-name"},[i("span",[s._v(s._s(s.tableData.get_user.username))]),s.tableData.get_user.level_icon?i("el-image",{staticClass:"level-icon",attrs:{src:s.tableData.get_user.level_icon,fit:"fill"}},[i("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[i("i",{staticClass:"el-icon-picture-outline"})])]):s._e()],1)])])],1),s._l(s.tableData.get_main_reply,function(a,t){return i("el-timeline-item",{key:"main_reply"+t,attrs:{timestamp:"[主评回复] "+a.create_time,type:"danger",placement:"top"}},[i("el-card",{attrs:{shadow:"never"}},[i("div",{staticClass:"user-icon"},[i("el-avatar",{attrs:{size:"medium",src:"image/avatar/admin.png"}})],1),i("div",{staticClass:"problem"},[i("div",{staticClass:"consult-content cs-pb-10"},[s._v(s._s(a.content))]),i("div",{staticStyle:{"line-height":"0"}},s._l(a.image,function(t,e){return i("el-image",{key:e,staticClass:"comment_thumb",attrs:{src:s._f("getPreviewUrl")(t,"comment_thumb_x40"),"preview-src-list":s.srcList,lazy:!0,fit:"cover"},on:{click:function(t){return t.stopPropagation(),s.setImageSrcList(a.image,e)}}})}),1),i("div",{staticClass:"user-name"},[i("span",[s._v("客服人员")])])])])],1)}),s.tableData.get_addition?i("el-timeline-item",{attrs:{timestamp:"[追评] "+s.tableData.get_addition.create_time,type:"primary",placement:"top"}},[i("el-card",{staticClass:"action",attrs:{shadow:"never"}},[i("div",{staticClass:"user-icon"},[i("el-avatar",{attrs:{size:"medium",src:s._f("getPreviewUrl")(s.tableData.get_user.head_pic,"head_pic")}},[i("img",{attrs:{src:"image/avatar/user.png",alt:""}})])],1),i("div",{staticClass:"problem"},[i("div",{staticClass:"consult-content cs-pb-10"},[i("span",[s._v(s._s(s.tableData.get_addition.content))]),i("el-button",{staticClass:"form-button active",attrs:{type:"text",size:"small"},on:{click:function(t){return s.initReplyForm(s.tableData.get_addition.goods_comment_id)}}},[s._v("回复")])],1),i("div",{staticStyle:{"line-height":"0"}},s._l(s.tableData.get_addition.image,function(t,e){return i("el-image",{key:e,staticClass:"comment_thumb",attrs:{src:s._f("getPreviewUrl")(t,"comment_thumb_x40"),"preview-src-list":s.srcList,lazy:!0,fit:"cover"},on:{click:function(t){return t.stopPropagation(),s.setImageSrcList(s.tableData.get_addition.image,e)}}})}),1),i("div",{staticClass:"user-name"},[i("span",[s._v(s._s(s.tableData.get_user.username))]),s.tableData.get_user.level_icon?i("el-image",{staticClass:"level-icon",attrs:{src:s.tableData.get_user.level_icon,fit:"fill"}},[i("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[i("i",{staticClass:"el-icon-picture-outline"})])]):s._e()],1)])])],1):s._e(),s._l(s.tableData.get_addition_reply,function(a,t){return i("el-timeline-item",{key:"addition_reply"+t,attrs:{timestamp:"[追评回复] "+a.create_time,type:"danger",placement:"top"}},[i("el-card",{attrs:{shadow:"never"}},[i("div",{staticClass:"user-icon"},[i("el-avatar",{attrs:{size:"medium",src:"image/avatar/admin.png"}})],1),i("div",{staticClass:"problem"},[i("div",{staticClass:"consult-content cs-pb-10"},[s._v(s._s(a.content))]),i("div",{staticStyle:{"line-height":"0"}},s._l(a.image,function(t,e){return i("el-image",{key:e,staticClass:"comment_thumb",attrs:{src:s._f("getPreviewUrl")(t,"comment_thumb_x40"),"preview-src-list":s.srcList,lazy:!0,fit:"cover"},on:{click:function(t){return t.stopPropagation(),s.setImageSrcList(a.image,e)}}})}),1),i("div",{staticClass:"user-name"},[i("span",[s._v("客服人员")])])])])],1)})],2),i("el-form",{directives:[{name:"has",rawName:"v-has",value:"/goods/opinion/comment/detail",expression:"'/goods/opinion/comment/detail'"}],ref:"form",attrs:{model:s.form,rules:s.rules,id:"reply-form","label-width":"68px"}},[s.form.isShowReply?i("el-form-item",{attrs:{prop:"content"}},[i("el-input",{attrs:{placeholder:"请输入回复内容",type:"textarea",autosize:{minRows:5},"show-word-limit":!0,maxlength:"200"},model:{value:s.form.content,callback:function(t){s.$set(s.form,"content",t)},expression:"form.content"}}),i("div",{staticStyle:{"line-height":"0"}},s._l(s.form.image,function(t,e){return i("el-image",{key:e,staticClass:"comment_thumb",staticStyle:{margin:"10px 5px 0 0"},attrs:{src:s._f("getPreviewUrl")(t,"comment_thumb_x40"),"preview-src-list":s.srcList,lazy:!0,fit:"cover"},on:{click:function(t){return t.stopPropagation(),s.setImageSrcList(s.form.image,e)}}})}),1),i("cs-upload",{attrs:{type:"slot",accept:"image/*"},on:{confirm:s._getUploadFileList}},[i("el-button",{staticStyle:{float:"left",margin:"10px 10px 0 0"},attrs:{slot:"control",type:"info",size:"small"},slot:"control"},[s._v("上传图片")])],1),i("el-button",{staticClass:"cs-mt-10",attrs:{type:"primary",loading:s.submitLoading,size:"small"},on:{click:s.handleFormSubmit}},[s._v("提交")])],1):s._e()],1)],1)],1)},[],!1,null,"3a0af844",null);e.default=c.exports}}]);