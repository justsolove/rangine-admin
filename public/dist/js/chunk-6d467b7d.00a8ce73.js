(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-6d467b7d"],{"04e3":function(t,e,n){"use strict";n.r(e);n("8e6e"),n("456d"),n("ac6a");var s=n("bd86"),o=n("ca00"),a=n("2f62"),u=n("041d");function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,s)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(n,!0).forEach(function(t){Object(s.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var r={props:{loading:{default:!1},typeList:{default:function(){}},tableData:{default:function(){return[]}}},data:function(){return{currentTableData:[],multipleSelection:[],auth:{show:!1,hide:!1,del:!1,detail:!1},statusMap:{0:{text:"待回复",type:"warning"},1:{text:"已回复",type:"success"}}}},filters:{getPreviewUrl:function(t){return Array.isArray(t)&&0<t.length&&t[0].source?o.a.getImageCodeUrl(t[0].source,"goods_image_x80"):""}},watch:{tableData:{handler:function(t){this.currentTableData=t},immediate:!0}},activated:function(){this.updateChange({name:"goods-opinion-consult",source:this.currentTableData,key:"goods_consult_id"})},mounted:function(){this._validationAuth()},methods:d({},Object(a.b)("careyshop/update",["updateChange"]),{_validationAuth:function(){this.auth.show=this.$has("/goods/opinion/consult/show"),this.auth.hide=this.$has("/goods/opinion/consult/hide"),this.auth.del=this.$has("/goods/opinion/consult/del"),this.auth.detail=this.$has("/goods/opinion/consult/detail")},_getIdList:function(t){null===t&&(t=this.multipleSelection);var e=[];return Array.isArray(t)?t.forEach(function(t){e.push(t.goods_consult_id)}):e.push(this.currentTableData[t].goods_consult_id),e},handleSelectionChange:function(t){this.multipleSelection=t},handleShow:function(t,e,n){var s=this,o=1<arguments.length&&void 0!==e?e:0,a=2<arguments.length&&void 0!==n&&n,i=this._getIdList(t);if(0!==i.length){if(!a){var r=this.currentTableData[t],l=r.is_show?0:1;if(1<r.is_show)return;if(0==l&&!this.auth.show)return;if(1==l&&!this.auth.hide)return;return this.$set(this.currentTableData,t,d({},r,{is_show:2})),void c(i,l,this)}this.$confirm("确定要执行该操作吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",closeOnClickModal:!1}).then(function(){c(i,o,s)}).catch(function(){})}else this.$message.error("请选择要操作的数据");function c(n,s,o){Object(u.e)(n,s).then(function(){o.currentTableData.forEach(function(t,e){-1!==n.indexOf(t.goods_consult_id)&&o.$set(o.currentTableData,e,d({},t,{is_show:s}))}),o.$message.success("操作成功")})}},handleDelete:function(t){var e=this,n=this._getIdList(t);0!==n.length?this.$confirm("确定要执行该操作吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",closeOnClickModal:!1}).then(function(){Object(u.a)(n).then(function(){for(var t=e.currentTableData.length-1;0<=t;t--)-1!==n.indexOf(e.currentTableData[t].goods_consult_id)&&e.currentTableData.splice(t,1);e.currentTableData.length<=0&&e.$emit("refresh",!0),e.$message.success("操作成功")})}).catch(function(){}):this.$message.error("请选择要操作的数据")},openConsultDetail:function(t){this.auth.detail&&this.$router.push({name:"goods-opinion-consult-detail",params:{goods_consult_id:t}})},handleView:function(t){this.$router.push({name:"goods-admin-view",params:{goods_id:t}})}})},l=(n("64e2"),n("2877")),c=Object(l.a)(r,function(){var n=this,t=n.$createElement,s=n._self._c||t;return s("div",{staticClass:"cs-p"},[s("el-form",{attrs:{inline:!0,size:"small"}},[n.auth.del?s("el-form-item",[s("el-button",{attrs:{disabled:n.loading},on:{click:function(t){return n.handleDelete(null)}}},[s("cs-icon",{attrs:{name:"trash-o"}}),n._v("\n        批量删除\n      ")],1)],1):n._e(),s("cs-help",{staticStyle:{"padding-bottom":"19px"},attrs:{router:n.$route.path}})],1),s("el-table",{directives:[{name:"loading",rawName:"v-loading",value:n.loading,expression:"loading"}],attrs:{data:n.currentTableData},on:{"selection-change":n.handleSelectionChange}},[s("el-table-column",{attrs:{type:"selection",width:"35"}}),s("el-table-column",{attrs:{label:"商品咨询","min-width":"550"},scopedSlots:n._u([{key:"default",fn:function(e){return[s("div",{staticClass:"goods-consult"},[s("el-image",{staticClass:"goods-image",attrs:{src:n._f("getPreviewUrl")(e.row.get_goods.attachment),fit:"contain",lazy:""},on:{click:function(t){return n.handleView(e.row.get_goods.goods_id)}}}),s("div",{staticClass:"goods-info cs-ml"},[s("span",{staticClass:"link",attrs:{title:e.row.get_goods.name},on:{click:function(t){return n.handleView(e.row.get_goods.goods_id)}}},[n._v(n._s(e.row.get_goods.name))]),s("div",{staticClass:"consult-content"},[s("p",[s("el-tag",{attrs:{type:n.statusMap[e.row.status].type,effect:"plain",size:"mini"}},[n._v("\n                  "+n._s(n.statusMap[e.row.status].text)+"\n                ")]),s("span",{staticClass:"cs-pl-5",class:{title:n.auth.detail},attrs:{title:e.row.content},on:{click:function(t){return n.openConsultDetail(e.row.goods_consult_id)}}},[n._v(n._s(e.row.content))])],1),s("p",[n._v(n._s(e.row.create_time))])])])],1)]}}])}),s("el-table-column",{attrs:{"min-width":"130"},scopedSlots:n._u([{key:"default",fn:function(t){return[s("div",{staticClass:"user-info"},[s("p",[s("span",[n._v(n._s(t.row.get_user.username||"游客"))]),t.row.get_user.level_icon?s("el-image",{staticClass:"level-icon",attrs:{src:t.row.get_user.level_icon,fit:"fill"}},[s("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[s("i",{staticClass:"el-icon-picture-outline"})])]):n._e()],1),s("p",[n._v(n._s(n.typeList[t.row.type]))])])]}}])}),s("el-table-column",{attrs:{label:"操作",align:"center","min-width":"120"},scopedSlots:n._u([{key:"default",fn:function(e){return[n.auth.show||n.auth.hide?s("el-button",{attrs:{size:"small",type:"text"},on:{click:function(t){return n.handleShow(e.$index)}}},[n._v(n._s(e.row.is_show?"隐藏":"显示"))]):n._e(),n.auth.del?s("el-button",{attrs:{size:"small",type:"text"},on:{click:function(t){return n.handleDelete(e.$index)}}},[n._v("删除")]):n._e()]}}])})],1)],1)},[],!1,null,"a7161f1c",null);e.default=c.exports},"64e2":function(t,e,n){"use strict";var s=n("f6cd");n.n(s).a},f6cd:function(t,e,n){}}]);